<h2>Selected Blog</h2>
<h1><%= @blog.title %></h1>
<h2><%= @blog.body %></h2>
<p>Created By: <%= @blog.user.full_name if @blog.user %></p>
<p>Tags: <%= @blog.tags.map {|t| t.title.capitalize }.join(", ") %></p>
 <% if user_signed_in? %>
    <% if @blog.faved_by(current_user) %>
      <%= link_to "unfav  ", post_favourite_path(@blog, @blog.fave_for(current_user)), method: :delete  %>
    <% else %>
      <%= link_to "fav  ", post_favourites_path(@blog), method: :post %>
    <% end %>
     <br>
     <%= "your ratings #{current_user.stars.where(post_id: @blog).first.ratings}" if current_user.stars.where(post_id: @blog).first   %>


    <br>
    <% if @blog.stared_by?(current_user) %>
        <%= link_to "1",     post_star_path(@blog, current_user_star, {star: {ratings: 1}}),
                               method: :patch %>
        <%= link_to "2",     post_star_path(@blog, current_user_star, {star: {ratings: 2}}),
                               method: :patch %>
        <%= link_to "3",     post_star_path(@blog, current_user_star, {star: {ratings: 3}}),
                               method: :patch %>
        <%= link_to "4",     post_star_path(@blog, current_user_star, {star: {ratings: 4}}),
                               method: :patch %>
        <%= link_to "5",     post_star_path(@blog, current_user_star, {star: {ratings: 5}}),
                               method: :patch %>
        <%= link_to "Clear", post_star_path(@blog, current_user_star),
                               method: :delete,
                               data: {disable_with: "..."}%>
    <% else %>
        <%= link_to "1", post_stars_path(@blog, star:{ratings: 1}), method: :post%>
        <%= link_to "2", post_stars_path(@blog, star:{ratings: 2}), method: :post%>
        <%= link_to "3", post_stars_path(@blog, star:{ratings: 3}), method: :post%>
        <%= link_to "4", post_stars_path(@blog, star:{ratings: 4}), method: :post%>
        <%= link_to "5", post_stars_path(@blog, star:{ratings: 5}), method: :post%>
    <% end %>

    <br>
    <% if can? :manage, @blog%>
        <%= link_to "Edit", edit_post_path( @blog) %>
        <%= link_to "Delete", post_path(@blog),
                              method: :delete,
                              data: {confirm: "Are you sure?"} %><br>
    <% end %>
    <%= @comment.errors.full_messages.join(", ") %> <br>

    <%= form_for [@blog, @comment] do |f| %>
       <h3>commnets</h3>
       <%= f.text_area :body %>
       <br>
       <%= f.submit %>
    <% end %>
<% end %>

<h2>Comments</h2>
<div>

<% @blog.new_first_comment.each do |comment| %>
  <%= comment.body %>
  <p>By: <%= comment.user.full_name if comment.user %></p>
  <% if can? :manage, comment %>
  <%= link_to "Delete", post_comment_path(@blog, comment),
                        method: :delete,
                        data: {confirm: "Are you sure?"} %>
  <% end %>
  <hr>

<% end %>

</div>
